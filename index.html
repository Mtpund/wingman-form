<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wingman Onboarding Form</title>
  <style>
    body {
      font-family: 'Helvetica Neue', sans-serif;
      background-color: #fefbf6;
      color: #222;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .form-container {
      background: white;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      width: 90%;
      max-width: 600px;
      padding: 2rem;
    }
    .progress-bar {
      display: flex;
      justify-content: space-between;
      margin-bottom: 2rem;
    }
    .progress-step {
      flex: 1;
      height: 6px;
      margin: 0 2px;
      background-color: #e0e0e0;
      border-radius: 3px;
    }
    .progress-step.active {
      background-color: #1c7155;
    }
    .question {
      font-size: 1.25rem;
      font-weight: bold;
      margin-bottom: 1rem;
    }
    .input-wrapper {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    textarea, input[type="text"], input[type="email"], input[type="date"] {
      font-size: 1rem;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #ccc;
      width: 100%;
    }
    .option-button {
  background-color: #f0f8f5;
  border: 1px solid #1c7155;
  border-radius: 24px;
  padding: 6px 10px;
  font-size: 0.8rem;
  cursor: pointer;
  transition: all 0.3s ease;
  display: inline-block;
  margin: 2px;
  white-space: nowrap;
}
    .option-button.selected {
      background-color: #1c7155;
      color: #fff;
    }
    .btn {
      margin-top: 2rem;
      background-color: #1c7155;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .btn:hover {
      background-color: #155a43;
    }
    .popup {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: rgba(0, 0, 0, 0.6);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 999;
    }
    .popup.active {
      display: flex;
    }
    .popup-content {
      background-color: white;
      padding: 2rem;
      border-radius: 12px;
      max-width: 400px;
      text-align: center;
    }
    .popup-content button {
      margin-top: 1rem;
      padding: 8px 16px;
      background-color: #1c7155;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .popup-content a {
      color: #1c7155;
    }
  </style>
</head>
<body>
  <div class="form-container">
    <div class="progress-bar" id="progress-bar"></div>
    <form id="wingmanForm"></form>
  </div>
  <div class="popup" id="crisisPopup">
    <div class="popup-content">
      <p>For crisis support/immediate help please dial <strong>988</strong> for the Suicide & Crisis Hotline, <strong>911</strong>, or one of the resources <a href="https://mhanational.org/resources/resources-for-immediate-response/" target="_blank">here</a>.</p>
      <button id="closePopup">Close</button>
    </div>
  </div>
  <script>
    const formFields = [
  {
    question: 'What are you looking for right now? We will provide you with personalized recommendations that could be helpful. Select all that apply.',
    type: 'bubbles',
    name: 'lookingFor',
    multi: true,
    options: ['Mental Health Coaching','Therapy/Counseling','Community/Support Groups','Crisis Support/Immediate Help','Self Help Resources/Tools','Peer Support/Mentorship','Specialized Support (i.e. addiction, fatherhood, relationships, identity, etc.)']
  },
  {
    question: 'What are your goals in using Wingman?<br><small style="font-weight: normal; color: #666;">Select all that apply.</small>',
    type: 'bubbles',
    name: 'goals',
    multi: true,
    options: [
      'Get to the gym more regularly',
      'Eat healthier',
      'Sleep better',
      'Reduce stress',
      'Feel less anxious',
      'Improve work-life balance',
      'Be more productive at work',
      'Communicate better with my partner or family',
      'Have more confidence',
      'Break bad habits (like drinking too much, smoking, or procrastinating)',
      'Feel happier or more motivated',
      'Make more time for hobbies or things I enjoy',
      'Handle anger or frustration better',
      'Be a better dad/partner/friend',
      'Deal with big life changes (like a breakup, job loss, becoming a dad, etc.)',
      'Make new friends or improve my social life',
      'Set and stick to personal goals',
      'Stop feeling stuck or overwhelmed',
      'Find more meaning or purpose in life',
      'Manage money or financial stress better',
      'Get support for quitting substances (alcohol, drugs, etc.)',
      'Feel more in control of my emotions',
      'Have more energy during the day',
      'Spend less time on my phone or gaming',
      'Feel less lonely',
      'Build better daily routines',
      'Stay accountable to my goals',
      'Deal with grief or loss',
      'Prepare for a new job or career change',
      'Other'
    ]
  },
  { 
    question: 'If you could only pick one superpower for your coach, what would it be?', 
    type: 'bubbles', 
    name: 'superpower', 
    options: ['Incredible Listener','Amazing Motivator','Wealth of Wisdom','Calm, Cool, and Collected','A+ Accountability','Your Bigger Fan & Champion'] 
  },
  { 
    question: 'Have you ever worked with a mental health coach, therapist, or counselor in the past?', 
    type: 'bubbles', 
    name: 'experience', 
    options: ['Yes', 'No'] 
  },
  {
    question: 'Tell us a bit about yourself',
    type: 'group',
    fields: [
      { label: 'Full Name', type: 'text', name: 'name' },
      { label: 'Date of Birth', type: 'date', name: 'dob' },
      { label: 'Email Address', type: 'email', name: 'email' },
      { label: 'Phone Number', type: 'text', name: 'phone' }
    ]
  },
  {
    question: 'Emergency Contact Information',
    type: 'group',
    fields: [
      { label: 'Emergency Contact Full Name', type: 'text', name: 'emergencyName' },
      { label: 'Emergency Contact Email', type: 'email', name: 'emergencyEmail' },
      { label: 'Emergency Contact Phone', type: 'text', name: 'emergencyPhone' }
    ]
  },
  
];

let pastExperienceField = {
  question: `Please share more context on the type(s) of professionals you've seen, how recent, and for which issues.
<small style="font-weight: normal; color: #666; display: block; margin-top: 0.5rem;">No problem if you don't want to share right now! It's just helpful for building our recommendations and facilitating coach matching.</small>`,
  type: 'textarea',
  name: 'pastExperience',
  optional: true
};

    let currentStep = 0;
    const form = document.getElementById('wingmanForm');
    const progressBar = document.getElementById('progress-bar');
    const popup = document.getElementById('crisisPopup');
    const closePopup = document.getElementById('closePopup');
    if (closePopup) closePopup.addEventListener('click', () => popup.classList.remove('active'));

    function renderProgressBar() {
      if (!progressBar) return;
      progressBar.innerHTML = '';
      formFields.forEach((_, i) => {
        const stepEl = document.createElement('div');
        stepEl.className = 'progress-step' + (i <= currentStep ? ' active' : '');
        progressBar.appendChild(stepEl);
      });
    }

    function renderStep() {
      const field = formFields[currentStep];
      form.innerHTML = '';
      renderProgressBar();

      const questionEl = document.createElement('div');
      questionEl.className = 'question';
      questionEl.innerHTML = field.question;
      form.appendChild(questionEl);

      const wrapper = document.createElement('div');
      wrapper.className = 'input-wrapper';
if (field.name === 'goals') {
  wrapper.style.flexDirection = 'row';
  wrapper.style.justifyContent = 'flex-start';
  wrapper.style.alignItems = 'flex-start';
  wrapper.style.columnGap = '0.5rem';
  wrapper.style.rowGap = '0.5rem';
}
wrapper.style.flexWrap = 'wrap';
      let inputEl;

      if (field.type === 'textarea') {
  inputEl = document.createElement('textarea');
  inputEl.name = field.name;
  wrapper.appendChild(inputEl);
} else if (field.type === 'bubbles') {
        inputEl = document.createElement('input');
        inputEl.type = 'hidden';
        inputEl.name = field.name;
        wrapper.appendChild(inputEl);

        const selections = new Set();

        field.options.forEach(opt => {
          const btn = document.createElement('button');
          btn.type = 'button';
          btn.className = 'option-button';
          btn.textContent = opt;
          btn.onclick = () => {
            btn.classList.toggle('selected');
            selections.has(opt) ? selections.delete(opt) : selections.add(opt);
            inputEl.value = Array.from(selections).join(', ');
            if (opt === 'Crisis Support/Immediate Help' && selections.has(opt)) popup.classList.add('active');
          };
          wrapper.appendChild(btn);
        });
      } else if (field.type === 'group') {
  field.fields.forEach(subField => {
    const label = document.createElement('label');
    label.textContent = subField.label;
    const input = document.createElement('input');
    input.type = subField.type;
    input.name = subField.name;
    input.required = true;
    wrapper.appendChild(label);
    wrapper.appendChild(input);
  });
} else {
  inputEl = document.createElement('input');
  inputEl.type = field.type;
  inputEl.name = field.name;
  wrapper.appendChild(inputEl);
}

      form.appendChild(wrapper);

      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'btn';
      btn.textContent = currentStep === formFields.length - 1 ? 'Submit' : 'Next';
      btn.onclick = () => {
        if (!inputEl || inputEl.checkValidity()) {
          currentStep++;
          if (currentStep < formFields.length) {
            // Inject follow-up if 'experience' = 'Yes'
            if (formFields[currentStep - 1]?.name === 'experience') {
              const response = document.querySelector('input[name="experience"]').value;
              if (response.includes('Yes')) formFields.splice(currentStep, 0, pastExperienceField);
            }
            renderStep();
          } else {
            form.innerHTML = `
              <div class="question">Thank you! We've received your responses.</div>
              <a href="https://www.wingmanmentalhealth.com/pricing" class="btn">Choose Your Wingman Package</a>
            `;
          }
        } else {
          inputEl.reportValidity();
        }
      };
      form.appendChild(btn);
    }

    renderStep();
  </script>
</body>
</html>
