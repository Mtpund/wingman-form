<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wingman Onboarding Form</title>
  <style>
    body {
      font-family: 'Helvetica Neue', sans-serif;
      background-color: #000;
      color: #fff;
      margin: 0;
      padding: 2rem;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
    }
    .form-container {
      background: #fff;
      color: #000;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
      width: 100%;
      max-width: 850px;
      padding: 3rem;
    }
    .progress-bar {
      display: flex;
      justify-content: space-between;
      margin-bottom: 2rem;
    }
    .progress-step {
      flex: 1;
      height: 6px;
      margin: 0 2px;
      background-color: #ddd;
      border-radius: 3px;
    }
    .progress-step.active {
      background-color: #1c7155;
    }
    .question {
      font-size: 1.4rem;
      font-weight: 600;
      margin-bottom: 1rem;
    }
    .input-wrapper {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
  justify-content: flex-start;
  align-items: flex-start;
  margin-top: 1.5rem;
}
    textarea, input[type="text"], input[type="email"], input[type="date"] {
      font-size: 1rem;
      padding: 12px 16px;
      border-radius: 10px;
      border: 1px solid #ccc;
      width: 100%;
      background-color: #f9f9f9;
      color: #000;
    }
    .option-button {
  background-color: #f0f0f0;
  border: 1px solid #1c7155;
  border-radius: 20px;
  padding: 6px 10px;
  font-size: 0.85rem;
  cursor: pointer;
  transition: all 0.3s ease;
  margin: 4px;
  color: #000;
  white-space: nowrap;
  flex: 0 1 auto;
}
.option-button.selected {
  background-color: #1c7155;
  color: #fff;
}
    .option-button.selected {
      background-color: #1c7155;
      color: #fff;
    }
    .btn {
      align-self: flex-start;
      margin-top: 2rem;
      background-color: #1c7155;
      color: white;
      padding: 12px 24px;
      border: none;
      border-radius: 10px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .btn:hover {
      background-color: #155a43;
    }
    .popup {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: rgba(0, 0, 0, 0.6);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 999;
    }
    .popup.active {
      display: flex;
    }
    .popup-content {
      background-color: #111;
      color: #fff;
      padding: 2rem;
      border-radius: 12px;
      max-width: 400px;
      text-align: center;
    }
    .popup-content button {
      margin-top: 1rem;
      padding: 10px 20px;
      background-color: #1c7155;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .popup-content a {
      color: #1c7155;
    }
  </style>
</head>
<body style="position: relative; z-index: 0;">
  <div class="form-container">
    <div class="progress-bar" id="progress-bar"></div>
    <form id="wingmanForm"></form>
  </div>
  <div class="popup" style="z-index: 1000;" id="crisisPopup">
    <div class="popup-content">
      <p>For crisis support/immediate help please dial <strong>988</strong> for the Suicide & Crisis Hotline, <strong>911</strong>, or one of the resources <a href="https://mhanational.org/resources/resources-for-immediate-response/" target="_blank">here</a>.</p>
      <button id="closePopup">Close</button>
    </div>
  </div>
  <script>
const formFields = [
  
  {
    id: "userGoals",
    question: "What are your goals in using Wingman?",
    type: "multi-select",
    options: [
      "Get to the gym more regularly",
      "Eat healthier",
      "Sleep better",
      "Reduce stress",
      "Feel less anxious",
      "Improve work-life balance",
      "Be more productive at work",
      "Communicate better with my partner or family",
      "Have more confidence",
      "Break bad habits (like drinking too much, smoking, or procrastinating)",
      "Feel happier or more motivated",
      "Make more time for hobbies or things I enjoy",
      "Handle anger or frustration better",
      "Be a better dad/partner/friend",
      "Deal with big life changes (like a breakup, job loss, becoming a dad, etc.)",
      "Make new friends or improve my social life",
      "Set and stick to personal goals",
      "Stop feeling stuck or overwhelmed",
      "Find more meaning or purpose in life",
      "Manage money or financial stress better",
      "Get support for quitting substances (alcohol, drugs, etc.)",
      "Feel more in control of my emotions",
      "Have more energy during the day",
      "Spend less time on my phone or gaming",
      "Feel less lonely",
      "Build better daily routines",
      "Stay accountable to my goals",
      "Deal with grief or loss",
      "Prepare for a new job or career change",
      "Other"
    ]
  },
  {
    id: "goals",
    question: "What are you looking for right now? We will provide you with personalized recommendations that could be helpful. Select all that apply.",
    type: "multi-select",
    options: [
      "Mental Health Coaching",
      "Therapy/Counseling",
      "Community/Support Groups",
      "Crisis Support/Immediate Help",
      "Self Help Resources/Tools",
      "Peer Support/Mentorship",
      "Specialized Support (i.e. addiction, fatherhood, relationships, identity, etc.)"
    ]
  },
  {
    id: "superpower",
    question: "If you could only pick one superpower for your coach, what would it be?",
    type: "single-select",
    options: [
      "Incredible Listener",
      "Amazing Motivator",
      "Wealth of Wisdom",
      "Calm, Cool, and Collected",
      "A+ Accountability",
      "Your Bigger Fan & Champion"
    ]
  },
  {
    id: "workedWithCoach",
    question: "Have you ever worked with a mental health coach, therapist, or counselor in the past?",
    type: "single-select",
    options: ["Yes", "No"]
  },
  {
    id: "pastExperience",
    question: "Please share more context on the type(s) of professionals you've seen, how recent, and for which issues.",
    type: "textarea",
    optional: true,
    dependsOn: { fieldId: "workedWithCoach", value: "Yes" },
    subtext: "No problem if you don't want to share right now! It's just helpful for building our recommendations and facilitating coach matching."
  },
  {
    id: "contactInfo",
    question: "Let's get your contact details.",
    type: "group",
    fields: [
      { id: "fullName", type: "text", label: "Full Name" },
      { id: "dob", type: "date", label: "Date of Birth" },
      { id: "email", type: "email", label: "Email" },
      { id: "phone", type: "text", label: "Phone Number" }
    ]
  },
  {
    id: "emergencyContact",
    question: "Emergency Contact Information",
    type: "group",
    fields: [
      { id: "emergencyFullName", type: "text", label: "Emergency Contact Full Name" },
      { id: "emergencyEmail", type: "email", label: "Email" },
      { id: "emergencyPhone", type: "text", label: "Phone Number" }
    ]
  }
];

const form = document.getElementById("wingmanForm");
const popup = document.getElementById("crisisPopup");
const closePopup = document.getElementById("closePopup");
const progressBar = document.getElementById("progress-bar");

let step = 0;
let formData = {};

function renderProgressBar() {
  progressBar.innerHTML = "";
  formFields.forEach((_, idx) => {
    const stepDiv = document.createElement("div");
    stepDiv.className = "progress-step" + (idx <= step ? " active" : "");
    progressBar.appendChild(stepDiv);
  });
}

function renderStep() {
  renderProgressBar();
  form.innerHTML = "";
  const field = formFields[step];

  if (field.dependsOn) {
    const { fieldId, value } = field.dependsOn;
    if (formData[fieldId] !== value) {
      step++;
      renderStep();
      return;
    }
  }

  const wrapper = document.createElement("div");
  wrapper.className = "input-wrapper";

  const label = document.createElement("label");
  label.className = "question";
  label.innerText = field.question;
  wrapper.appendChild(label);

  if (field.subtext) {
    const sub = document.createElement("small");
    sub.innerText = field.subtext;
    wrapper.appendChild(sub);
  }

  if (field.type === "multi-select" || field.type === "single-select") {
    const optionsContainer = document.createElement("div");
    optionsContainer.style.display = "flex";
    optionsContainer.style.flexWrap = "wrap";
    optionsContainer.style.gap = "0.5rem";
    optionsContainer.style.marginTop = "1rem";
    wrapper.appendChild(optionsContainer);

    formData[field.id] = field.type === "multi-select" ? formData[field.id] || [] : "";

    field.options.forEach(opt => {
      const btn = document.createElement("button");
      btn.className = "option-button";
      btn.type = "button";
      btn.innerText = opt;

      if (field.type === "multi-select") {
        btn.onclick = () => {
          if (formData[field.id].includes(opt)) {
            formData[field.id] = formData[field.id].filter(o => o !== opt);
            btn.classList.remove("selected");
          } else {
            formData[field.id].push(opt);
            btn.classList.add("selected");
            if (opt === "Crisis Support/Immediate Help") popup.classList.add("active");
          }
        };
      } else {
        btn.onclick = () => {
          formData[field.id] = opt;
          Array.from(optionsContainer.children).forEach(child => child.classList.remove("selected"));
          btn.classList.add("selected");
          if (field.id === "superpower" || field.id === "workedWithCoach") nextStep();
        };
      }

      optionsContainer.appendChild(btn);
    });
  }

  if (field.type === "textarea") {
    const textarea = document.createElement("textarea");
    textarea.placeholder = "Type your response here...";
    textarea.value = formData[field.id] || "";
    textarea.oninput = (e) => formData[field.id] = e.target.value;
    wrapper.appendChild(textarea);
  }

  if (field.type === "group") {
    const groupContainer = document.createElement("div");
    groupContainer.style.display = "flex";
    groupContainer.style.flexDirection = "column";
    groupContainer.style.gap = "1.5rem";
    groupContainer.style.marginTop = "1rem";
    groupContainer.style.width = "100%";

    field.fields.forEach(subField => {
      const fieldWrapper = document.createElement("div");
      fieldWrapper.style.display = "flex";
      fieldWrapper.style.flexDirection = "column";

      const label = document.createElement("label");
      label.style.marginBottom = "0.5rem";
      label.style.fontWeight = "500";
      label.innerText = subField.label;
      fieldWrapper.appendChild(label);

      const input = document.createElement("input");
      input.type = subField.type;
      input.name = subField.id;
      input.value = formData[subField.id] || "";
      input.style.marginBottom = "0.5rem";
      input.oninput = (e) => formData[subField.id] = e.target.value;
      fieldWrapper.appendChild(input);

      groupContainer.appendChild(fieldWrapper);
    });
    wrapper.appendChild(groupContainer);
  }

  const btn = document.createElement("button");
  btn.innerText = (step === formFields.length - 1 && field.id !== "emergencyContact") ? "Submit" : "Next";
  btn.className = "btn";
  btn.type = "button";
  btn.onclick = () => {
    if (field.type === "single-select" && field.id !== "workedWithCoach" && !formData[field.id]) {
      alert("Please select an option to continue.");
      return;
    }
    if (step < formFields.length - 1) {
      step++;
      renderStep();
    } else {
      renderFinal();
    }
  };

  if (field.id !== "workedWithCoach" && field.id !== "superpower") {
    wrapper.appendChild(btn);
  }

  form.appendChild(wrapper);
}
function renderFinal() {
  form.innerHTML = `
    <div class="input-wrapper">
      <p class="question">Thank you! We've received your responses. Click the button below to choose your package & get started.</p>
      <a href="https://www.wingmanmentalhealth.com/pricing" class="btn">Choose Your Wingman Package</a>
    </div>
  `;
  renderProgressBar();
}

if (closePopup) {
  closePopup.addEventListener("click", () => popup.classList.remove("active"));
}

function nextStep() {
  step++;
  renderStep();
}

renderStep();
</script>
</body>
</html>
